# A novel combination therapy for ER+ breast cancer suppresses drug resistance via an evolutionary double-bind

**Authors**: Rena Emond, Jeffrey West, Vince K. Grolmusz, Patrick A. Cosgrove, Aritro Nath, Alexander R.A. Anderson, Andrea H. Bild

**Link to preprint**: [here](https://www.biorxiv.org/content/10.1101/2024.09.03.611032v1here).

This repository provides the MATLAB and MUSYC code for the manuscript above.

---

## Practical Guide

### 1. Installation & Setup

#### MATLAB Requirements
*   **MATLAB Version**: Recommended R2020b or later.
*   **Toolboxes**:
    *   Statistics and Machine Learning Toolbox (required for statistical functions like `sem`).
    *   Optimization Toolbox (may be required for fitting).

#### Setting up the Environment
1.  Clone or download this repository to your local machine.
2.  Open MATLAB.
3.  Navigate to the repository folder: `ER-breast-cancer-evolutionary-double-bind`.
4.  **Important**: Add the repository and its subfolders to your MATLAB path to ensure all scripts and helper functions are accessible. You can do this by running the following command in the MATLAB Command Window:
    ```matlab
    addpath(genpath(pwd));
    savepath; % Optional: saves the path for future sessions
    ```

### 2. Repository Organization

The repository is organized into five main directories, each corresponding to a specific part of the analysis pipeline:

#### `EGA/` (Evolutionary Game Assay)
Contains code for the game theory analysis and fitness landscape modeling (Figures 4 and 5).
*   **Core Scripts**:
    *   `EGA.m`: The main script for running the Evolutionary Game Analysis. It processes data, calculates fitness, and generates state space plots.
    *   `runTrajectories.m`: Plots cell count trajectories over time.
    *   `plotFitness.m`: Visualizes the fitness landscapes.
*   **Figure Generation**:
    *   `figure4ABC.m`: Recreates the panels for Figure 4 (Game assay results).
    *   `figure5ABC.m`: Recreates the panels for Figure 5 (Evolutionary double-bind simulations).
*   **Data**: `_CSV/` contains the raw time-course data for different cell lines (MCF7, T47D) and drugs (Doxorubicin, Paclitaxel).

#### `Musyc/` (Synergy Analysis)
Contains code for analyzing drug combination synergy using the MUSYC framework.
*   **Core Scripts**:
    *   `main_surface.m`: The primary script for generating 3D surface plots of drug interactions (Figure 2). It iterates through drugs and cell lines to visualize synergy/antagonism.
    *   `plotBestSurface.m`: Helper to plot the best-fit 3D surface.
*   **Data**:
    *   `_MUSYC/`: Input CSV files generated by the [Musyc tool](https://musyc.lolab.xyz/).
    *   `_MUSYC_Results/`: Output files from the analysis.

#### `Normalization/`
Scripts for preprocessing experimental data, specifically converting raw fluorescence values into cell counts.
*   **Key Scripts**: `norm_MCF7_Doxo.m`, `norm_MCF7_Pacli.m`, `norm_T47D_Pacli.m`. These use linear models to map fluorescence to cell numbers based on standard curves.
*   **Data**: Excel files containing the standard curve data.

#### `Surface/`
Contains the raw 2D dose-response data used for the surface analyses.
*   **Files**: Excel files (`.xlsx`) with dose-response matrices for various drug combinations.

#### `Validation/`
Code for validating the evolutionary models against experimental outcomes.
*   **Key Scripts**:
    *   `figure5DEF.m`: Generates validation figures comparing model predictions to experimental results.
    *   `create_EGA_CSVs.m`: Helper to format validation data.

### 3. How to Run the Code

1.  **To run the Evolutionary Game Analysis**:
    *   Open `EGA/EGA.m`.
    *   Adjust parameters if necessary (e.g., `cell_line`, `drug`).
    *   Run the script. Output plots will be saved to the `plots/` directory (created automatically or needs to be created).

2.  **To generate Surface Plots**:
    *   Open `Musyc/main_surface.m`.
    *   Run the script. It will generate figure windows for each drug combination defined in the loops.

3.  **To reproduce specific figures**:
    *   Run `EGA/figure4ABC.m` or `EGA/figure5ABC.m` directly. Ensure you are in the project root or have added all folders to the path.

---

**Note**: Some scripts perform file operations (reading/writing). Ensure you have write permissions in the directory.
