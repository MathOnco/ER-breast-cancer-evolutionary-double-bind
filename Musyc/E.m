% two-dimensional dose response from Wooten 2022
function [Ed] = E(d1,d2,E0,E1,E2,E3,r1,r2,C1,C2,h1,h2,a12,a21)

    Ed = (E3.*r1.*(a12.*d2).^h2.*(a21.*d1.^2).^h1 + ...
          E3.*r2.*(a21.*d1).^h1.*(a12.*d2.^2).^h2 + ... 
          C2.^h2.*E0.*r1.*(C1.*a21.*d1).^h1 +  ...
          C1.^h1.*E0.*r2.*(C2.*a12.*d2).^h2 +  ...
          C2.^h2.*E1.*r1.*(a21.*d1.^2).^h1 +  ...
          C1.^h1.*E2.*r2.*(a12.*d2.^2).^h2 +  ...
          E3.*d2.^h2.*r1.*(C1.*a21.*d1).^h1 +  ...
          E3.*d1.^h1.*r2.*(C2.*a12.*d2).^h2 +  ...
          C1.^(2.*h1).*C2.^h2.*E0.*r1 +  ...
          C1.^h1.*C2.^(2.*h2).*E0.*r2 +  ...
          C1.^(2.*h1).*E2.*d2.^h2.*r1 +  ...
          C2.^(2.*h2).*E1.*d1.^h1.*r2 +  ...
          E1.*r2.*(C2.*d2).^h2.*(a21.*d1).^h1 +  ...
          E2.*r1.*(C1.*d1).^h1.*(a12.*d2).^h2 + ...
          C2.^h2.*E1.*r1.*(C1.*d1).^h1 + ...
          C1.^h1.*E2.*r2.*(C2.*d2).^h2) ./ ...
          (r1.*(a12.*d2).^h2.*(a21.*d1.^2).^h1 +  ...
          r2.*(a21.*d1).^h1.*(a12.*d2.^2).^h2 +  ...
          C2.^h2.*r1.*(C1.*a21.*d1).^h1 + ...
          C1.^h1.*r2.*(C2.*a12.*d2).^h2 +  ...
          C2.^h2.*r1.*(a21.*d1.^2).^h1 +  ...
          C1.^h1.*r2.*(a12.*d2.^2).^h2 +  ...
          d2.^h2.*r1.*(C1.*a21.*d1).^h1 +  ...
          d1.^h1.*r2.*(C2.*a12.*d2).^h2 +  ...
          C1.^(2.*h1).*C2.^h2.*r1 +  ...
          C1.^h1.*C2.^(2.*h2).*r2 +  ...
          C1.^(2.*h1).*d2.^h2.*r1 +  ...
          C2.^(2.*h2).*d1.^h1.*r2 +  ...
          r1.*(C1.*d1).^h1.*(a12.*d2).^h2 + ... 
          r2.*(C2.*d2).^h2.*(a21.*d1).^h1 +  ...
          C2.^h2.*r1.*(C1.*d1).^h1 +  ...
          C1.^h1.*r2.*(C2.*d2).^h2);

end